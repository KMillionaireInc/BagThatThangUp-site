<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BagThat Deals</title>
  <link rel="icon" type="image/png" href="https://www.bagthatthangup.com/custompro.png" />
  <style>
  :root {
    --ink:#1b1b1b;
    --accent:#b7a98b;
    --bg:#f6f5f3;
    --white:#ffffff;
    --radius:18px;
    --shadow:0 8px 22px rgba(0,0,0,0.08);
    --muted:#6e6e6e;
  }
  body {
    margin:0;
    background:var(--bg);
    color:var(--ink);
    font-family:"Inter",system-ui,sans-serif;
  }
  #disclosure {
    position: sticky;
    top: 0;
    z-index: 2000;
    background: var(--ink);
    color: var(--white);
    text-align: center;
    font-size: 14px;
    padding: 10px 12px;
    letter-spacing: 0.3px;
  }
  header {
    background: #f6f4ee;
    text-align: center;
    padding: 46px 14px 26px;
    border-bottom: 1px solid #e7e0d4;
    position: sticky;
    top: 42px;
    z-index: 1500;
    box-shadow: none;
  }
  header h1 {
    font-family: "Playfair Display", serif;
    font-size: 46px;
    font-weight: 700;
    margin: 0 0 12px;
    letter-spacing: 0.6px;
    color: #1b1b1b;
    text-transform: uppercase;
    text-shadow: 0 0 12px rgba(183,169,139,0.55);
  }
  nav button {
    background: none;
    border: none;
    font-size: 16px;
    margin: 0 12px;
    cursor: pointer;
    font-weight: 600;
    color: #1b1b1b;
  }
  nav button.active,
  nav button:hover {
    color: #b7a98b;
    text-decoration: underline;
  }
  #welcomeBanner {
    background: #f7f5f1;
    text-align: center;
    padding: 26px 16px;
    font-size: 1.22rem;
    font-family: "Playfair Display", serif;
    color: #1b1b1b;
    border-top: 1px solid #e8e1d5;
    border-bottom: 1px solid #e8e1d5;
    letter-spacing: 0.2px;
  }
  #dealCount {
    background: #f6f4ee;
    padding: 16px;
    text-align: center;
    font-size: 16px;
    font-weight: 700;
    color: #b7a98b;
    border-bottom: 1px solid #e3dbcf;
  }
  #categoryBarWrapper {
    padding: 10px 18px;
    background: var(--bg);
    border-bottom: 1px solid rgba(0,0,0,0.05);
  }
  #categoryDropdown {
    width: 100%;
    padding: 10px 14px;
    font-size: 15px;
    border-radius: 12px;
    border: 1px solid #d2d2d2;
    background: var(--white);
    outline: none;
    color: var(--ink);
    margin-bottom: 8px;
  }
  #searchBarWrapper {
    position:sticky;
    top:110px;
    background:var(--bg);
    padding:14px 18px;
    z-index:1400;
    border-bottom:1px solid rgba(0,0,0,0.05);
  }
  #searchInput {
    width:100%;
    padding:12px 40px 12px 16px;
    font-size:15px;
    border-radius:14px;
    border:1px solid #d2d2d2;
    background:var(--white);
    outline:none;
  }
  #searchIcon {
    position:absolute;
    right:26px;
    top:50%;
    transform:translateY(-50%);
    opacity:0.55;
  }
  #deals {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:26px;
    padding:32px;
  }
  .card {
    background:var(--white);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
    display:flex;
    flex-direction:column;
  }
  .card.glow-highlight { box-shadow:0 0 18px rgba(183,169,139,0.8); border:2px solid var(--accent); }
  .card img { width:100%; object-fit:contain; aspect-ratio:1/1; background:var(--white); padding:12px; }
  .info { padding:16px 20px; }
  .asin { font-size:0.75rem; color:var(--muted); margin-bottom:6px; }
  .info h3 { font-size:15px; font-weight:600; margin:0 0 10px; display:flex; justify-content:space-between; align-items:center; color:var(--ink); }
  .cc-badge { background:#f3efe7; color:var(--ink); font-size:0.7rem; padding:2px 6px; border-radius:6px; font-weight:700; margin-left:4px; }
  .share-icon { cursor:pointer; opacity:0.85; }
  .rating { font-size:0.9rem; color:#d1a500; margin-bottom:6px; }
  .price { display:flex; align-items:baseline; gap:8px; margin-bottom:10px; }
  .price .discount { font-size:1.2rem; font-weight:700; color:var(--ink); }
  .price .original { color:#999; text-decoration:line-through; font-size:0.9rem; }
  .copy-code { background:#f3efe7; color:var(--ink); padding:6px 10px; font-size:0.78rem; font-weight:700; border-radius:6px; margin-top:6px; width:fit-content; cursor:pointer; }
  .coupon-flag { background:#fff8d1; color:#8a6a00; padding:4px 10px; font-size:0.8rem; font-weight:700; border-radius:8px; margin-top:10px; width:fit-content; }
  .cta { margin-top:auto; background:var(--accent); color:white; padding:14px; text-align:center; font-weight:700; text-decoration:none; border-radius:0 0 var(--radius) var(--radius); }
  .toast { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); background:var(--ink); color:white; padding:12px 18px; border-radius:8px; opacity:0; transition:opacity 0.3s; z-index:9999; }
  #visitorCounter {
    position: fixed;
    bottom: 14px;
    right: 14px;
    background: rgba(0,0,0,0.65);
    color: #fff;
    font-size: 12px;
    font-weight: 600;
    padding: 6px 10px;
    border-radius: 6px;
    z-index: 9999;
    backdrop-filter: blur(4px);
  }
  </style>
</head>
<body>
<div id="disclosure">
  As an Amazon Associate, I earn from qualifying purchases. Prices/Codes/Coupons can change anytime.
</div>

<header>
  <h1 id="storeName">Loading...</h1>
  <div id="subHeaderTagline">Daily promo codes, coupons & curated finds — curated savings every day.</div>
  <nav>
    <button id="tab-today" class="active">Today's Deals</button>
    <button id="tab-yesterday">Yesterday</button>
    <button id="tab-almost">Almost Gone</button>
  </nav>
</header>

<div id="socialLinksBar" style="text-align:center;padding:14px 0;background:#f6f4ee;border-bottom:1px solid #e7e0d4;display:none;">
  <a id="btnAmazon"    href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">Amazon</a>
  <a id="btnInstagram" href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">Instagram</a>
  <a id="btnFacebook"  href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">Facebook</a>
  <a id="btnYouTube"   href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">YouTube</a>
  <a id="btnPinterest" href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">Pinterest</a>
  <a id="btnTikTok"    href="#" target="_blank" style="margin:0 8px;font-weight:600;font-size:14px;color:#1b1b1b;text-decoration:none;">TikTok</a>
</div>

<div id="welcomeBanner">
  Welcome to <span id="storeGreeting">Your Store</span> — let's save big today!
</div>

<div id="dealCount">Deals: 0</div>

<div id="categoryBarWrapper">
  <select id="categoryDropdown">
    <option value="">All Categories</option>
    <option value="Clothing">Clothing</option>
    <option value="Jewelry & Accessories">Jewelry & Accessories</option>
    <option value="Beauty/Wellness">Beauty/Wellness</option>
    <option value="Home & Furniture">Home & Furniture</option>
    <option value="Kitchen">Kitchen</option>
    <option value="Electronics">Electronics</option>
    <option value="Fitness">Fitness</option>
    <option value="Kids/Toys">Kids/Toys</option>
    <option value="Pets">Pets</option>
    <option value="Outdoor & Garden">Outdoor & Garden</option>
    <option value="Sports/Outdoor">Sports/Outdoor</option>
    <option value="Automotive">Automotive</option>
  </select>
</div>

<div id="searchBarWrapper">
  <div id="searchContainer">
    <input id="searchInput" placeholder="Search deals...">
    <svg id="searchIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
  </div>
</div>

<main id="deals">Loading deals...</main>
<div id="toast" class="toast">Copied!</div>
<div id="visitorCounter"></div>

<script>
function parseCSV(text){const rows=[];let row=[];let cell="";let insideQuotes=false;for(let i=0;i<text.length;i++){const c=text[i];if(c==='"'&&text[i+1]==='"'){cell+='"';i++;continue;}if(c==='"'){insideQuotes=!insideQuotes;continue;}if(c===','&&!insideQuotes){row.push(cell);cell="";continue;}if(c==='\n'&&!insideQuotes){row.push(cell);rows.push(row);row=[];cell="";continue;}cell+=c;}if(cell.length||row.length){row.push(cell);rows.push(row);}return rows;}

const CSV_URLS={
  today:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS8B3eTxf5t0-v2m2NNicpty89ci6LRrJlGnwauS0sLZa8VyAjpnHI1h15s0le8hEsqRbcS9BB0VwFm/pub?gid=23655256&single=true&output=csv",
  yesterday:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS8B3eTxf5t0-v2m2NNicpty89ci6LR
