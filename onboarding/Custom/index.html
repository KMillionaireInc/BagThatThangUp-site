<!doctype html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BagThat | Custom Onboarding</title></head>
<body>
<form id="customForm">
<h2>Set up your Custom site</h2>
<input name="store_display_name" placeholder="Store name" required>
<input name="email" type="email" placeholder="Contact email" required>
<input name="subdomain" placeholder="Subdomain" required>
<input name="amazon_tag" placeholder="Amazon Associates ID" required>
<button type="submit">Submit onboarding</button>
</form>
<script>
document.getElementById('customForm').addEventListener('submit',async e=>{
  e.preventDefault();
  const f=new FormData(e.target);
  const q=new URLSearchParams([...f.entries()]);
  q.append('plan','custom');
  q.append('callback','cb');
  const url='https://script.google.com/macros/s/AKfycbytm-ntU4HHZq4PDXpwr4qoflZUy8Hcg-7GFLT0RFUJGuKIG0Zy3lIDEYTRBt7UVqkK/exec?'+q.toString();
  try{
    const res=await fetch(url);
    const text=await res.text();
    if(text.includes('"ok":true')){
      location.href='/success/?domain='+f.get('subdomain')+'.bagthatthangup.com&store='+encodeURIComponent(f.get('store_display_name'));
    }else alert('Error saving your info.');
  }catch(err){alert('Network error. Try again.');}
});
</script>
</body>
</html>
