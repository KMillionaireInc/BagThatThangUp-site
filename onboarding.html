<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BagThat â€” Onboarding</title>
<style>
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background: #f6faf9;
    color: #0b1320;
    margin: 0;
    padding: 0;
  }
  main {
    max-width: 480px;
    margin: 60px auto;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 26px rgba(2,24,43,0.12);
    padding: 32px;
  }
  h1 { font-size: 1.5rem; text-align: center; margin-bottom: 1rem; }
  form { display: flex; flex-direction: column; gap: 12px; }
  label { font-weight: 600; font-size: 0.9rem; }
  input {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 1rem;
  }
  button {
    background: #1f6f63;
    color: white;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    padding: 12px;
    cursor: pointer;
    margin-top: 8px;
  }
  button:hover { background: #15554b; }
</style>
</head>
<body>

<main>
  <h1>Set Up Your BagThat Storefront</h1>
  <form id="onboardForm">
    <label>Store Display Name</label>
    <input name="site_display_name" required>

    <label>Subdomain (store name)</label>
    <input name="subdomain" required placeholder="yourstorename">

    <label>Amazon Associate Tag</label>
    <input name="amazon_tag" required placeholder="example-20">

    <label>Email Address</label>
    <input name="email" type="email" required>

    <button type="submit">Create My Storefront</button>
  </form>
</main>

<script>
const form = document.getElementById("onboardForm");

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(form));
  const webhookUrl = "https://hook.us2.make.com/YOUR_MAIN_WEBHOOK_URL"; // replace with your actual Make webhook

  try {
    const res = await fetch(webhookUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data),
    });

    const result = await res.json().catch(() => ({}));

    if (result.error) {
      alert(result.message || "That site name is already taken. Please try another.");
      return;
    }

    // redirect to success page
    window.location.href = `https://bagthatthangup.com/success?subdomain=${encodeURIComponent(data.subdomain)}`;
  } catch (err) {
    alert("Something went wrong. Please try again.");
    console.error(err);
  }
});
</script>

</body>
</html>
